<!doctype html>
<html lang="en" class="h-100" data-bs-theme="dark">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Monitoring Temperature with MQTT and Home Assistant</title>
		<meta name="description" content="Coding and more">
		
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
		<meta name="generator" content="Eleventy v3.1.1">
		
		
		<style>@import url('https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap');

body {
	/* font-size: 1rem; */
	font-family: "Open Sans", sans-serif;
	font-optical-sizing: auto;
}

div.main-content {
	margin-top: 4rem;
	font-size: 1.2rem;
}

.blog-list a {
	text-decoration: none;
}

.post-meta .post-date time {
	color: #52a0d7;
}

div.main-content h1 {
	color: #c3e6ff;
	margin-bottom: 1rem;
}

div.main-content h2 {
	color: #ffd97f;
	margin-bottom: 1rem;
}

div.main-content h3 {
	color: #f0ff7f;
	margin-bottom: 1rem;
}

div.main-content pre {
	font-size: 1.1rem;
	background-color: #31363b;
	border: 1px solid #3f4851;
	padding: 0.5rem;
	margin-bottom: 1rem;
}

div.main-content picture img {
	border: 1px solid #454d55;
	max-width: 100%;
	height: auto;
	border-radius: 0.5rem;
	margin-bottom: 1rem;
	box-shadow: 5px 5px 10px 0px #2b3137;
}

div.main-content div.prev-next {
	background-color: #293037;
	border-radius: 0.5rem;
	padding: 0.5rem;
}

div.main-content table {
	border: 1px solid #363c43;
}

div.main-content .list-group-item:hover {
	background-color: #2b3137;
}
/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}</style>
		
		<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1689302880129363" crossorigin="anonymous"></script>
	</head>
	<!-- Google tag (gtag.js) -->
	<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HRDC8SXRVG"></script>
	
	<body class="d-flex flex-column h-100">
		<header>
			<nav class="navbar navbar-expand-md navbar-dark fixed-top" style="background-color:rgb(53, 76, 92);">
				<div class="container-fluid">
					<a class="navbar-brand" href="/">RichardN</a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarCollapse">
						<ul class="navbar-nav me-auto mb-2 mb-md-0">
							<li class="nav-item">
								<a class="nav-link " href="/">Home</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/about/">About</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/blog/">Blog</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/projects/">Projects</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/series/">Series</a>
							</li>
						</ul>
					</div>
				</div>
        	</nav>
		</header>
		<main class="flex-shrink-0">
			<div class="container main-content">
				


<h1 id="monitoring-temperature-with-mqtt-and-home-assistant">Monitoring Temperature with MQTT and Home Assistant</h1>

<div class="p-1 mb-1 d-flex post-meta">
		<span>
			<i class="bi bi-bookmarks-fill"></i>
				<a href="/tags/home-assistant/" class="post-tag">home assistant</a>
		</span>
	<div class="p-2 flex-grow-1">&nbsp;</div>
	<span class="post-date">
		<i class="bi bi-calendar-plus-fill"></i>
		<time datetime="2017-09-26">26 September 2017</time>
	</span>
</div>

<p>Today I will be looking at collecting and presenting temperature and humidity published by a couple of <code>DHT11 &amp; ESP8266</code> microcontrollers around the house. The code used to generate the messages will be covered at a later stage, however to get up and running quickly in your home I would suggest making use of the <a href="https://www.letscontrolit.com/wiki/index.php/Main_Page">ESP Easy</a> project as it's really simple to get up and running with.</p>
<p>You will need to ensure that you have configured Home Assistant to talk to your MQTT server (<a href="/blog/2017/2017-09-13/post/">look at step 2 in this post</a>), your sensor has been deployed, and it's successfully publishing information to your MQTT broker. You will also need to know what topic the data is being published to (in my case this is <code>dht/temperature/xxx</code>) - if you are not too sure of the exact topic you can always make use of any <a href="/blog/2017/2017-08-29/post/">MQTT dumper</a> application to log all messages passing through your broker.</p>
<h2 id="configuring-the-sensors">Configuring the sensors</h2>
<p>We will be making use of the <a href="https://www.home-assistant.io/integrations/sensor.mqtt">MQTT sensor component</a> provided with Home Assistant to collect our temperature and humidity data. In order to do this we will need to define a new sensor, point it to the correct topic and tell Home Assistant the unit of measurement to use when tracking this data.</p>
<p>I like to split out the configuration sections of Home Assistant into their own unique files (usually a single file per section), and include them back into the main configuration file via the <code>&lt;section&gt;: !include &lt;path&gt;</code> syntax as shown below:</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-26/post/efKZ7ROT3k-496.avif 496w"><source type="image/webp" srcset="/blog/2017/2017-09-26/post/efKZ7ROT3k-496.webp 496w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-26/post/efKZ7ROT3k-496.png" alt="" width="496" height="149"></picture>
<p>In my case I will be adding the following lines into my <code>config/sensors.yaml</code> file:</p>
<pre class="language-yaml" tabindex="0"><code class="language-yaml"><span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> mqtt
  <span class="token key atrule">state_topic</span><span class="token punctuation">:</span> <span class="token string">"dht/temperature/node_kitchen"</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Temperature (Kitchen)
  <span class="token key atrule">qos</span><span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token key atrule">unit_of_measurement</span><span class="token punctuation">:</span> celsius

<span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> mqtt
  <span class="token key atrule">state_topic</span><span class="token punctuation">:</span> <span class="token string">"dht/humidity/node_kitchen"</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Humidity (Kitchen)
  <span class="token key atrule">qos</span><span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token key atrule">unit_of_measurement</span><span class="token punctuation">:</span> <span class="token string">"%"</span>

<span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> mqtt
  <span class="token key atrule">state_topic</span><span class="token punctuation">:</span> <span class="token string">"dht/heat_index/node_kitchen"</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Heat Index (Kitchen)
  <span class="token key atrule">qos</span><span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token key atrule">unit_of_measurement</span><span class="token punctuation">:</span> <span class="token string">"%"</span>

<span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> mqtt
  <span class="token key atrule">state_topic</span><span class="token punctuation">:</span> <span class="token string">"misc/light_reading/node_kitchen"</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Light (Kitchen)
  <span class="token key atrule">qos</span><span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token key atrule">unit_of_measurement</span><span class="token punctuation">:</span> <span class="token string">"/1023"</span></code></pre>
<p>As you can see from the above there is nothing too special going on with the configuration. I defined 4 new sensors (<code>temperature</code>, <code>humidity</code>, <code>heat_index</code> and <code>light_index</code>), all of them getting their data from the mqtt platform. I define a name and unit of measurement for each data source (this will help Home Assistant to graph the data and group similar sources together). Then lastly I defined a QOS (Quality Of Service) of 0 for each device (basically telling Home Assistant that I don't necessarily care if I miss some data - <a href="https://www.hivemq.com/blog/mqtt-essentials-part-6-mqtt-quality-of-service-levels/">more on QOS here</a>).</p>
<p>After a quick restart of Home Assistant I can now see my new values being displayed at the top of my home view.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-26/post/vSnKwOG6EJ-413.avif 413w"><source type="image/webp" srcset="/blog/2017/2017-09-26/post/vSnKwOG6EJ-413.webp 413w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-26/post/vSnKwOG6EJ-413.png" alt="" width="413" height="103"></picture>
<h2 id="creating-a-group">Creating a group</h2>
<p>I prefer to have this data being displayed as a card and not clutter up the top bar as it is currently doing. To do this I will need to make use of the group feature in Home Assistant. Groups are collections of entities that we can define and are used to display any sensory data that Home Assistant provides. Furthermore groups can be converted into views (which appear as tabs along the top bar) and help to create specific views that cater to a common theme or area of our home automation.</p>
<p>In order to create a group we will first need to know the entity ids/names that Home Assistant assigned to our new data sources. To get the entity_ids you will need to navigate to the state's (1) view and search for them in the list (2) returned.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-26/post/yTb-ZKACZN-725.avif 725w"><source type="image/webp" srcset="/blog/2017/2017-09-26/post/yTb-ZKACZN-725.webp 725w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-26/post/yTb-ZKACZN-725.png" alt="" width="725" height="305"></picture>
<p>In my case I will be grouping the following entities:</p>
<ul>
<li>sensor.heat_index_kitchen</li>
<li>sensor.humidity_kitchen</li>
<li>sensor.light_kitchen</li>
<li>sensor.temperature_kitchen</li>
</ul>
<p>In my config/groups.yaml file I declared a new group called sensors_kitchen_groupand added the discovered entities above into it:</p>
<pre class="language-yaml" tabindex="0"><code class="language-yaml"><span class="token key atrule">sensors_kitchen_group</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Kitchen Sensors
  <span class="token key atrule">entities</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> sensor.heat_index_kitchen
    <span class="token punctuation">-</span> sensor.humidity_kitchen
    <span class="token punctuation">-</span> sensor.light_kitchen
    <span class="token punctuation">-</span> sensor.temperature_kitchen</code></pre>
<p>After saving the file and restarting Home Assistant the new Kitchen group appears in Home Assistants navigation bar:</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-26/post/PMJjul3eww-398.avif 398w"><source type="image/webp" srcset="/blog/2017/2017-09-26/post/PMJjul3eww-398.webp 398w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-26/post/PMJjul3eww-398.png" alt="" width="398" height="286"></picture>
<h2 id="creating-a-view">Creating a view</h2>
<p>As I mentioned above, views are just groups with a view: yes attribute assigned to them (and almost always an icon). Views are able to group together both entities and groups and makes them ideal to break up your now cluttered home dashboard into logical sections relating to a specific topic or area of your house. Seeing that my collected temperature information is being published by a node in my kitchen I would like to create a kitchen view to present this data, I define the view just like I would a group (also in the config/groups.yaml file) as shown below:</p>
<pre class="language-yaml" tabindex="0"><code class="language-yaml"><span class="token key atrule">kitchen_view</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Kitchen
  <span class="token key atrule">view</span><span class="token punctuation">:</span> yes
  <span class="token key atrule">icon</span><span class="token punctuation">:</span> mdi<span class="token punctuation">:</span>food<span class="token punctuation">-</span>fork<span class="token punctuation">-</span>drink
  <span class="token key atrule">entities</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> device_tracker.niemandr_hwnxt
    <span class="token punctuation">-</span> group.security_kitchen_group
    <span class="token punctuation">-</span> group.sensors_kitchen_group</code></pre>
<p>After restarting Home Assistant I can see a new tab next to the default Home tab using the <code>mdi:food-fork-drink</code> icon from <a href="https://materialdesignicons.com/">material design icons</a> with the name Kitchen if hovered over. When opening the view we are now presented with only the data that we selected above - no more clutter!</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-26/post/nMsQHiK69G-664.avif 664w"><source type="image/webp" srcset="/blog/2017/2017-09-26/post/nMsQHiK69G-664.webp 664w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-26/post/nMsQHiK69G-664.png" alt="" width="664" height="443"></picture>
<p>After some time you will be able to graph the collected information (as shown below) to get an idea of how these values may change through the day.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-26/post/x8Wd_H8VSO-372.avif 372w"><source type="image/webp" srcset="/blog/2017/2017-09-26/post/x8Wd_H8VSO-372.webp 372w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-26/post/x8Wd_H8VSO-372.png" alt="" width="372" height="355"></picture>
<p>This information can now be used in all manners of home automation with the only limit being your imagination. You may want to automate the air conditioner in your lounge to maintain an ideal temperature, or enable a fan in your dog's kennel should it get too hot inside, and so on.</p>
<p>I hope that you found this post interesting, and as always I welcome any comments or suggestions in the comments section below.</p>

<div class="d-flex mb-3 prev-next">
	<i class="bi bi-arrow-left-short"></i>
	<span class="text-start">Previous<br><a href="/blog/2017/2017-09-19/post/">Monitoring my Gate with Home Assistant for under $5</a></span>
	
	<div class="p-2 flex-grow-1">&nbsp;</div>
	<span class="text-end">Next<br><a href="/blog/2017/2017-10-03/post/">Sonoff &amp; MQTT Example (Lounge Light)</a></span>
	<i class="bi bi-arrow-right-short"></i>
	
</div>



			</div>
		</main>
		<footer class="footer mt-auto py-3 bg-body-tertiary">
			<div class="container text-end">
				<span class="text-body-secondary">
					<a href="https://github.com/rniemand" target="_blank">GitHub</a>
				</span>
			</div>
		</footer>
		<!-- This page `/blog/2017/2017-09-26/post/` was built on 2025-07-07T22:37:44.937Z -->
		<script type="module" src="/dist/uHLRy2-o6f.js"></script>
		<script src="//cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
	</body>
</html>
