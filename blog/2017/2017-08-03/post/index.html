<!doctype html>
<html lang="en" class="h-100" data-bs-theme="dark">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Changing Sonoff Firmware (Visual Guide)</title>
		<meta name="description" content="Coding and more">
		
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
		<meta name="generator" content="Eleventy v3.1.1">
		
		<style>@import url("https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap");

body {
	font-family: "Open Sans", sans-serif;
	font-optical-sizing: auto;
}

.navbar .navbar-brand.active,
.navbar-nav .nav-item .nav-link.active {
	border-bottom: 1px solid #e0e9f2;
}

div.main-content {
	margin-top: 4rem;
	font-size: 1.1rem;
}

.blog-list a {
	text-decoration: none;
}

.post-meta .post-date time {
	color: #f3fe90;
}

div.main-content > h1 {
	color: #c3e6ff;
	margin-bottom: 1rem;
}

div.main-content > h2 {
	color: #ffd97f;
	margin-bottom: 1rem;
}

div.main-content h2.quick-access {
	color: #7cbbe6;
}

div.main-content > h3 {
	color: #f0ff7f;
	margin-bottom: 1rem;
}

div.main-content pre {
	font-size: 1.1rem;
	background-color: #31363b;
	border: 1px solid #3f4851;
	padding: 0.5rem;
	margin-bottom: 1rem;
}

div.main-content picture img:not(.no-borders) {
	border: 1px solid #454d55;
	max-width: 100%;
	height: auto;
	border-radius: 0.5rem;
}

div.main-content picture {
	display: block;
}
div.main-content picture:has(img.text-center) {
	text-align: center;
}

div.main-content picture img {
	margin-bottom: 1rem;
	box-shadow: 5px 5px 10px 0px #2b3137;
}

div.main-content div.prev-next {
	background-color: #293037;
	border-radius: 0.5rem;
	padding: 0.5rem;
}

div.main-content table {
	border: 1px solid #363c43;
	font-size: 1rem;
}

div.main-content .list-group-item:hover {
	background-color: #2b3137;
}

div.main-content .accordion {
	margin-bottom: 1rem;
}

div.main-content .accordion .accordion-item .accordion-body {
	background-color: #2a2f35;
}
/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}</style>
		
		<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1689302880129363" crossorigin="anonymous"></script>
	</head>
	<!-- Google tag (gtag.js) -->
	<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HRDC8SXRVG"></script>
	
	<body class="d-flex flex-column h-100">
		<header>
			<nav class="navbar navbar-expand-md navbar-dark fixed-top" style="background-color:rgb(53, 76, 92);">
				<div class="container-fluid">
					<a class="navbar-brand " href="/">RichardN</a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarCollapse">
						<ul class="navbar-nav me-auto mb-2 mb-md-0">
							<li class="nav-item">
								<a class="nav-link " href="/projects/">Projects</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/tags/">Tags</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/blog/">Archive</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		</header>
		<main class="flex-shrink-0">
			<div class="container main-content">
				


<h1 id="changing-sonoff-firmware-visual-guide">Changing Sonoff Firmware (Visual Guide)</h1>

<div class="p-1 mb-1 d-flex post-meta">
		<span>
			<i class="bi bi-bookmarks-fill"></i>
				<a href="/tags/arduino/" class="post-tag">arduino</a>, 
				<a href="/tags/iot/" class="post-tag">iot</a>
		</span>
	<div class="p-2 flex-grow-1">&nbsp;</div>
	<span class="post-date">
		<i class="bi bi-calendar-plus-fill"></i>
		<time datetime="2017-08-03">03 August 2017</time>
	</span>
</div>

<p>About a year ago I discovered <a href="https://sonoff.tech/product/diy-smart-switch/basicr2/">Sonoff WiFi switches</a> on <a href="https://www.aliexpress.com/">AliExpress</a> and was able to pick up a couple of them for $10. These devices are basically IoT connected smart switches that you can control via your smartphone, or their website, and for the most part work pretty well right out of the box for most consumers. Until recently I was more than happy to use them &quot;as is&quot; with the shipped firmware and mobile application, and it was only when I wanted to integrate these switches into my home automation did I find the shipped firmware and software quite limiting.</p>
<p>After some Googling I discovered an awesome project on GitHub called <a href="https://github.com/arendst/Tasmota">Sonoff-Tasmota</a>, a custom firmware created specifically for Sonoff devices that allows me to customise what these devices can do. This post will cover the steps required to get the firmware up and running on your Sonoff devices.</p>
<h2 id="adding-programming-header">Adding programming header</h2>
<p>In order to flash any firmware to your device, you are going to need to open it up and attach some header pins to the circuit board. This will make flashing the initial firmware a lot easier, and allow for troubleshooting the device over a serial connection.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/ABPK_iJMSA-1024.avif 1024w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/ABPK_iJMSA-1024.webp 1024w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/ABPK_iJMSA-1024.jpeg" alt="" width="1024" height="362"></picture>
<p>Start by removing the cable cover plates as shown above, then using a screwdriver to pop off the backing plate of the device.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/dMzupfTNbK-1024.avif 1024w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/dMzupfTNbK-1024.webp 1024w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/dMzupfTNbK-1024.jpeg" alt="" width="1024" height="691"></picture>
<p>Next you will need to locate the programming header pin holes (on the right of the push button, just above the small microchip). There should be 5 of them.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/36F_XIjYLo-800.avif 800w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/36F_XIjYLo-800.webp 800w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/36F_XIjYLo-800.jpeg" alt="" width="800" height="448"></picture>
<p>Solder on some header pins as shown above, making sure you are careful not to damage any of the surrounding components.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/G9YdjruQhK-800.avif 800w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/G9YdjruQhK-800.webp 800w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/G9YdjruQhK-800.jpeg" alt="" width="800" height="1144"></picture>
<p>New header pins on the board.</p>
<h2 id="setting-up-flashing-environment">Setting up Flashing Environment</h2>
<p>Next you will need an IDE / Application to compile &amp; upload your custom firmware. I followed the steps detailed in the official guide (<a href="https://github.com/arendst/Sonoff-Tasmota/wiki/Upload">https://github.com/arendst/Sonoff-Tasmota/wiki/Upload</a>), but decided to take the <a href="https://code.visualstudio.com/">Visual Studio Code</a> with <a href="https://platformio.org/">PlatformIO</a> as it seemed easier at the time.</p>
<p>Open VS Code, navigate to the plugins tab and search for PlatformIO as shown below. Click install and wait for it to complete.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/M-hyexR5Sd-1013.avif 1013w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/M-hyexR5Sd-1013.webp 1013w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/M-hyexR5Sd-1013.png" alt="" width="1013" height="474"></picture>
<p>Once installed I recommend restarting VS Code and allowing PlatformIO to pull down any additional dependencies it may have.</p>
<h2 id="download-sonoff-tasmota">Download Sonoff-Tasmota</h2>
<p>Next, head over to the official <a href="https://github.com/arendst/Tasmota/releases">Sonoff-Tasmota</a> release page and download the latest stable version of the firmware (<code>5.5.0 20170730</code> at the time of writing).</p>
<p>Extract the contents of the release .zip file to an easily accessible folder on your computer (in my case <code>D:\Tools\Sonoff\Sonoff-Tasmota-5.5.0</code>).</p>
<p>Open the folder in VS Code as shown below.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/8rrcWA818f-446.avif 446w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/8rrcWA818f-446.webp 446w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/8rrcWA818f-446.png" alt="" width="446" height="175"></picture>
<p>You are now ready to customise your firmware.</p>
<h2 id="firmware-customization">Firmware Customization</h2>
<p>Open the <code>platform.ini</code> file (in the root folder) and locate the below line, removing the comment (;) to enable it.</p>
<pre><code>env_default = sonoff
</code></pre>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/jfLnjsjcxf-709.avif 709w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/jfLnjsjcxf-709.webp 709w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/jfLnjsjcxf-709.png" alt="" width="709" height="108"></picture>
<p>Next open sonoff/user_config.h, locate the WiFi settings as shown below and modify the SSID and password for your WiFi network.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/F_YRAradSO-970.avif 970w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/F_YRAradSO-970.webp 970w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/F_YRAradSO-970.png" alt="" width="970" height="276"></picture>
<p>After that, locate the MQTT configuration in the same file and enter in your MQTTconfiguration. If you are using TLS you will need to complete section (1), otherwise enter your values in section (2) and save the file.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/3lIHtbADJl-681.avif 681w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/3lIHtbADJl-681.webp 681w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/3lIHtbADJl-681.png" alt="" width="681" height="267"></picture>
<p>That completed all the configuration.</p>
<h2 id="flashing-firmware">Flashing firmware</h2>
<p>To flash your firmware to the Sonoff switch you will need an ISP of some sorts. Unfortunately I didn't have one on me, so I had to make a plan using an Arduino UNO with its microprocessor removed (see below).</p>
<p>I found a nice picture detailing the pin-out on (<a href="https://randomnerdtutorials.com/">https://randomnerdtutorials.com/</a>):</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/ZEuoAIcSsc-749.avif 749w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/ZEuoAIcSsc-749.webp 749w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/ZEuoAIcSsc-749.png" alt="" width="749" height="424"></picture>
<p>Following the picture as a guide and using my UNO I made all the necessary connections to the Sonoff before giving power to the UNO.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/dqUP7i6p1t-1024.avif 1024w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/dqUP7i6p1t-1024.webp 1024w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/dqUP7i6p1t-1024.jpeg" alt="" width="1024" height="535"></picture>
<blockquote>
<p><strong>NOTE</strong> To put the Sonoff into flash mode you will need to hold down the power switch while powering it on!</p>
</blockquote>
<p>Once connected, make sure that VS Code and PlatformIO can see your programmer's (in my case the UNO) serial port. There should be a row of icons at the bottom left hand side of VS Code, provided you have the Tasmota folder open.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/1x0osMxvBt-281.avif 281w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/1x0osMxvBt-281.webp 281w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/1x0osMxvBt-281.png" alt="" width="281" height="23"></picture>
<p>Click the upload button and wait for it to complete. It should take about a minute to do the initial upload as shown below.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/ucjzs9-nkm-1265.avif 1265w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/ucjzs9-nkm-1265.webp 1265w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/ucjzs9-nkm-1265.png" alt="" width="1265" height="298"></picture>
<p>Provided that there were no errors flashing you should be up and running with the Sonoff-Tasmota firmware.</p>
<h2 id="connecting-to-your-device">Connecting to your device</h2>
<p>The last step in the flashing process is locating and connecting to your device over the WiFi. I found an amazing Android application called <a href="https://play.google.com/store/apps/details?id=com.overlook.android.fing&amp;hl=en">Fing</a> that makes this really easy, but feel free to use any other app you are comfortable with.</p>
<p>Once you know the IP Address of your device (in my case 192.168.0.15) open your preferred web browser and connect to it (e.g. http://192.168.0.15). You should be presented with a screen similar to the below.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-08-03/post/oKRfxZhAAF-344.avif 344w"><source type="image/webp" srcset="/blog/2017/2017-08-03/post/oKRfxZhAAF-344.webp 344w"><img loading="lazy" decoding="async" src="/blog/2017/2017-08-03/post/oKRfxZhAAF-344.png" alt="" width="344" height="547"></picture>
<p>That's it, you are done :)</p>
<blockquote>
<p><strong>NOTE</strong>: The relay will not trigger if you are powering the device via an ISP, it seems to only trigger on mains</p>
</blockquote>

<div class="d-flex mb-3 prev-next">
	<i class="bi bi-arrow-left-short"></i>
	<span class="text-start">Previous<br><a href="/blog/2017/2017-06-12/post/">Installing Node-RED as a Windows Service</a></span>
	
	<div class="p-2 flex-grow-1">&nbsp;</div>
	<span class="text-end">Next<br><a href="/blog/2017/2017-08-29/post/">MQTT Dumper (Alpha)</a></span>
	<i class="bi bi-arrow-right-short"></i>
	
</div>




			</div>
		</main>
		<footer class="footer mt-auto py-3 bg-body-tertiary">
			<div class="container text-end">
				<span class="text-body-secondary">
					View me on <a href="https://github.com/rniemand" target="_blank">GitHub</a>.
				</span>
			</div>
		</footer>
		<!-- This page `/blog/2017/2017-08-03/post/` was built on 2025-07-16T21:25:28.802Z -->
		<script type="module" src="/dist/FtW8cD1Sur.js"></script>
		<script src="//cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
		<script id="dsq-count-scr" src="//richardn-ca.disqus.com/count.js" async=""></script>
	</body>
</html>
