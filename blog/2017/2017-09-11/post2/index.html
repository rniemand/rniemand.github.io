<!doctype html>
<html lang="en" class="h-100" data-bs-theme="dark">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Running Home Assistant as a Windows Service</title>
		<meta name="description" content="Coding and more">
		
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
		<meta name="generator" content="Eleventy v3.1.1">
		
		
		<style>@import url("https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap");

body {
	font-family: "Open Sans", sans-serif;
	font-optical-sizing: auto;
}

div.main-content {
	margin-top: 4rem;
	font-size: 1.1rem;
}

.blog-list a {
	text-decoration: none;
}

.post-meta .post-date time {
	color: #52a0d7;
}

div.main-content > h1 {
	color: #c3e6ff;
	margin-bottom: 1rem;
}

div.main-content > h2 {
	color: #ffd97f;
	margin-bottom: 1rem;
}

div.main-content > h3 {
	color: #f0ff7f;
	margin-bottom: 1rem;
}

div.main-content pre {
	font-size: 1.1rem;
	background-color: #31363b;
	border: 1px solid #3f4851;
	padding: 0.5rem;
	margin-bottom: 1rem;
}

div.main-content picture img:not(.no-borders) {
	border: 1px solid #454d55;
	max-width: 100%;
	height: auto;
	border-radius: 0.5rem;
}

div.main-content picture img {
	margin-bottom: 1rem;
	box-shadow: 5px 5px 10px 0px #2b3137;
}

div.main-content div.prev-next {
	background-color: #293037;
	border-radius: 0.5rem;
	padding: 0.5rem;
}

div.main-content table {
	border: 1px solid #363c43;
	font-size: 1rem;
}

div.main-content .list-group-item:hover {
	background-color: #2b3137;
}

div.main-content .accordion {
	margin-bottom: 1rem;
}

div.main-content .accordion .accordion-item .accordion-body {
	background-color: #2a2f35;
}
/**
 * okaidia theme for JavaScript, CSS and HTML
 * Loosely based on Monokai textmate theme by http://www.monokai.nl/
 * @author ocodia
 */

code[class*="language-"],
pre[class*="language-"] {
	color: #f8f8f2;
	background: none;
	text-shadow: 0 1px rgba(0, 0, 0, 0.3);
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
	border-radius: 0.3em;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #272822;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #8292a2;
}

.token.punctuation {
	color: #f8f8f2;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #f92672;
}

.token.boolean,
.token.number {
	color: #ae81ff;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #a6e22e;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string,
.token.variable {
	color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.function,
.token.class-name {
	color: #e6db74;
}

.token.keyword {
	color: #66d9ef;
}

.token.regex,
.token.important {
	color: #fd971f;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
/*
 * New diff- syntax
 */

pre[class*="language-diff-"] {
	--eleventy-code-padding: 1.25em;
	padding-left: var(--eleventy-code-padding);
	padding-right: var(--eleventy-code-padding);
}
.token.deleted {
	background-color: hsl(0, 51%, 37%);
	color: inherit;
}
.token.inserted {
	background-color: hsl(126, 31%, 39%);
	color: inherit;
}

/* Make the + and - characters unselectable for copy/paste */
.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	-webkit-user-select: none;
	user-select: none;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	padding-top: 2px;
	padding-bottom: 2px;
}
.token.prefix.inserted,
.token.prefix.deleted {
	width: var(--eleventy-code-padding);
	background-color: rgba(0,0,0,.2);
}

/* Optional: full-width background color */
.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	margin-left: calc(-1 * var(--eleventy-code-padding));
	margin-right: calc(-1 * var(--eleventy-code-padding));
	text-decoration: none; /* override del, ins, mark defaults */
	color: inherit; /* override del, ins, mark defaults */
}</style>
		
		<script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1689302880129363" crossorigin="anonymous"></script>
	</head>
	<!-- Google tag (gtag.js) -->
	<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HRDC8SXRVG"></script>
	
	<body class="d-flex flex-column h-100">
		<header>
			<nav class="navbar navbar-expand-md navbar-dark fixed-top" style="background-color:rgb(53, 76, 92);">
				<div class="container-fluid">
					<a class="navbar-brand" href="/">RichardN</a>
					<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarCollapse">
						<ul class="navbar-nav me-auto mb-2 mb-md-0">
							<li class="nav-item">
								<a class="nav-link " href="/">Home</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/about/">About</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/blog/">Blog</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/projects/">Projects</a>
							</li>
							<li class="nav-item">
								<a class="nav-link " href="/series/">Series</a>
							</li>
						</ul>
					</div>
				</div>
        	</nav>
		</header>
		<main class="flex-shrink-0">
			<div class="container main-content">
				


<h1 id="running-home-assistant-as-a-windows-service">Running Home Assistant as a Windows Service</h1>

<div class="p-1 mb-1 d-flex post-meta">
		<span>
			<i class="bi bi-bookmarks-fill"></i>
				<a href="/tags/windows/" class="post-tag">windows</a>, 
				<a href="/tags/home-assistant/" class="post-tag">home assistant</a>
		</span>
	<div class="p-2 flex-grow-1">&nbsp;</div>
	<span class="post-date">
		<i class="bi bi-calendar-plus-fill"></i>
		<time datetime="2017-09-11">11 September 2017</time>
	</span>
</div>

<p>In this post I will cover some simple steps on how to get <a href="https://www.home-assistant.io/">Home Assistant</a> as a service on windows. I will be making use of a nifty utility called <a href="https://nssm.cc/">nssm</a> (the <code>Non-Sucking Service Manager</code>) which lives up to its name. Before you begin you will need to have the following prerequisites met:</p>
<ul>
<li><a href="https://www.python.org/">Python 3.x</a> installed (do not use 2.x)</li>
<li><a href="/blog/2017/2017-09-11/post1/">netifaces and Microsoft Visual C++ 14.0</a></li>
<li><a href="https://www.home-assistant.io/">Home Assistant</a> installed under some elevated account
<ul>
<li>In my case I am using the Administrator account :/</li>
</ul>
</li>
</ul>
<h2 id="initial-service-installation">Initial Service Installation</h2>
<p>The first thing you will need to do is find the location of <code>hass.exe</code> for the selected user account, in my case this was the path:</p>
<pre><code>C:\Users\Administrator\AppData\Local\Programs\Python\Python36-32\Scripts\hass.exe
</code></pre>
<p>Take note of the path for <code>hass.exe</code>, then download the latest release of <a href="https://nssm.cc/download">nssm</a> and place the <code>nssm.exe</code> in a location where it won't be deleted (you will need the exe for the lifetime of the service - I placed mine in <code>p:\tools\nssm.exe</code>). Open an elevated command prompt, navigate to the folder containing <code>nssm.exe</code> and run the below command:</p>
<pre><code>nssm.exe install
</code></pre>
<p>You will be presented with the following dialog:</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/RscwQA0q9S-445.avif 445w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/RscwQA0q9S-445.webp 445w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/RscwQA0q9S-445.png" alt="" width="445" height="244"></picture>
<p>On the Application tab populate the following fields:</p>
<ul>
<li><strong>Path</strong>: <code>C:\Users\&lt;user&gt;\AppData\Local\Programs\Python\Python36-32\Scripts\hass.exe</code></li>
<li><strong>Startup directory</strong>: C:\Users&lt;user&gt;\AppData\Roaming.homeassistant</li>
<li><strong>Service name</strong>: HomeAssistant</li>
</ul>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/wQGctJwvhR-447.avif 447w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/wQGctJwvhR-447.webp 447w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/wQGctJwvhR-447.png" alt="" width="447" height="244"></picture>
<p>On the Log on tab, ensure that you configure the service to run using the selected account you used to install Home Assistant (in my case this is the Administrator account).</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/cZtcUup9X1-445.avif 445w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/cZtcUup9X1-445.webp 445w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/cZtcUup9X1-445.png" alt="" width="445" height="244"></picture>
<p>Feel free to add some additional context to the Details tab, in my case I set it to the following:</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/BCWP26aKUu-444.avif 444w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/BCWP26aKUu-444.webp 444w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/BCWP26aKUu-444.png" alt="" width="444" height="245"></picture>
<p>Click Install Service to create the initial service (mine says Edit as I only took screenshots after getting it up and running). You should now have your newly installed Home Assistant service.</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/-Q5qoUByob-1009.avif 1009w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/-Q5qoUByob-1009.webp 1009w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/-Q5qoUByob-1009.png" alt="" width="1009" height="111"></picture>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>At this point I tried running the service, only to be greeted with absolutely nothing in my browser. Thankfully nssm comes with a nifty I/O feature that allows you to redirect the stdin, stdout and stderr streams to / from files on disk. To enable this logging you will need to edit your home assistant service by running the following command:</p>
<pre><code>nssm edit HomeAssistant
</code></pre>
<p>You will be presented with a slightly modified install screen where you can make changes to the service, more specifically the following changes on the I/Otab:</p>
<ul>
<li><strong>Output</strong>: <code>C:\Users\&lt;user&gt;\Desktop\output.log</code></li>
<li><strong>Error</strong>: <code>C:\Users\&lt;user&gt;\Desktop\error.log</code></li>
</ul>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/6k6dyiD3U1-447.avif 447w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/6k6dyiD3U1-447.webp 447w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/6k6dyiD3U1-447.png" alt="" width="447" height="245"></picture>
<p>Save your changes and restart the Home Assistant service while keeping an eye on your log files. I like to make use of <a href="https://www.baremetalsoft.com/baretail/">baretail</a> for this as it provides real time updates as the log file changes. After a few seconds my initial problem became clear:</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/oYQwZKEwh_-710.avif 710w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/oYQwZKEwh_-710.webp 710w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/oYQwZKEwh_-710.png" alt="" width="710" height="513"></picture>
<p>The Home Assistant instance I was running was not running under the correct user context hence the welcome message being displayed (not to worry this is corrected in the installation section above). After editing my service via nssm everything was working perfectly:</p>
<picture><source type="image/avif" srcset="/blog/2017/2017-09-11/post2/FRVuvMUlDI-709.avif 709w"><source type="image/webp" srcset="/blog/2017/2017-09-11/post2/FRVuvMUlDI-709.webp 709w"><img loading="lazy" decoding="async" src="/blog/2017/2017-09-11/post2/FRVuvMUlDI-709.png" alt="" width="709" height="506"></picture>
<p>Hopefully this saves you some time.</p>
<p>Please feel free to leave any comments, suggestions or improvements below as they are appreciated.</p>

<div class="d-flex mb-3 prev-next">
	<i class="bi bi-arrow-left-short"></i>
	<span class="text-start">Previous<br><a href="/blog/2017/2017-09-11/post1/">Home Assistant Missing Dependencies (Windows)</a></span>
	
	<div class="p-2 flex-grow-1">&nbsp;</div>
	<span class="text-end">Next<br><a href="/blog/2017/2017-09-11/post3/">Upgrading Home Assistant (Windows Service Edition)</a></span>
	<i class="bi bi-arrow-right-short"></i>
	
</div>


<div id="disqus_thread"></div>

<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			</div>
		</main>
		<footer class="footer mt-auto py-3 bg-body-tertiary">
			<div class="container text-end">
				<span class="text-body-secondary">
					<a href="https://github.com/rniemand" target="_blank">GitHub</a>
				</span>
			</div>
		</footer>
		<!-- This page `/blog/2017/2017-09-11/post2/` was built on 2025-07-09T14:04:58.662Z -->
		<script type="module" src="/dist/LMisDIHiWZ.js"></script>
		<script src="//cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
		<script id="dsq-count-scr" src="//richardn-ca.disqus.com/count.js" async=""></script>
	</body>
</html>
